<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FEDRA emulsion software from the OPERA Collaboration: EdbMath Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">FEDRA emulsion software from the OPERA Collaboration
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('classEdbMath.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="classEdbMath-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">EdbMath Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="EdbMath_8h_source.html">EdbMath.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aac1d05ff6ea6bea788c91790ae4abc0d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEdbMath.html#aac1d05ff6ea6bea788c91790ae4abc0d">EdbMath</a> ()</td></tr>
<tr class="separator:aac1d05ff6ea6bea788c91790ae4abc0d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5fdc34d2f809ad1d30ff0a1d38473b0e"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEdbMath.html#a5fdc34d2f809ad1d30ff0a1d38473b0e">~EdbMath</a> ()</td></tr>
<tr class="separator:a5fdc34d2f809ad1d30ff0a1d38473b0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a75a9e60614f2f7f5b74f8b3aa9b8d896"><td class="memItemLeft" align="right" valign="top">static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEdbMath.html#a75a9e60614f2f7f5b74f8b3aa9b8d896">Angle3</a> (float tx1, float ty1, float tx2, float ty2)</td></tr>
<tr class="separator:a75a9e60614f2f7f5b74f8b3aa9b8d896"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5084fc6a6adbb578f88fba629e524ad"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEdbMath.html#aa5084fc6a6adbb578f88fba629e524ad">ArrStat</a> (int n, float *x, float par[4])</td></tr>
<tr class="separator:aa5084fc6a6adbb578f88fba629e524ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6c275f3d3fa9ee955de93d060fdbb30"><td class="memItemLeft" align="right" valign="top">static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEdbMath.html#ab6c275f3d3fa9ee955de93d060fdbb30">DistancePointLine3</a> (float Point[3], float LineStart[3], float LineEnd[3], bool inside)</td></tr>
<tr class="separator:ab6c275f3d3fa9ee955de93d060fdbb30"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4762a9abac1bbf8e674e0d8a40e5ed0e"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEdbMath.html#a4762a9abac1bbf8e674e0d8a40e5ed0e">LFIT3</a> (float *X, float *Y, float *<a class="el" href="emthickness_8cpp.html#a1576eaf58e4371bc3238da5580c6679a">Z</a>, float *<a class="el" href="testBGReduction__By__ANN_8C.html#a3eb16b560d3adb6d694d0735cb73b9f6">W</a>, int L, float &amp;<a class="el" href="RecDispMC__Profiles__new_8C.html#aa802853a3bd3d52262dc64687073e7bf">X0</a>, float &amp;<a class="el" href="emthickness_8cpp.html#a548eee315dc4d7f1a3547451d4ef9c69">Y0</a>, float &amp;<a class="el" href="hwinit_8C.html#a96c31e89763ed89de18ee0a2945004ce">Z0</a>, float &amp;TX, float &amp;TY, float &amp;EX, float &amp;EY)</td></tr>
<tr class="separator:a4762a9abac1bbf8e674e0d8a40e5ed0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a621ec2567e15829a0365cff42987bfe9"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="Milproto_8h.html#ad25c00c18486b3c83c838f69f1af4204">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEdbMath.html#a621ec2567e15829a0365cff42987bfe9">LFITW</a> (float *X, float *Y, float *<a class="el" href="testBGReduction__By__ANN_8C.html#a3eb16b560d3adb6d694d0735cb73b9f6">W</a>, int L, int KEY, float &amp;A, float &amp;<a class="el" href="emthickness_8cpp.html#a35d5b4c2bfa16a3c612587f58411a75f">B</a>, float &amp;E)</td></tr>
<tr class="separator:a621ec2567e15829a0365cff42987bfe9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5b38de32c4529d8f73466054f3caa87"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEdbMath.html#ac5b38de32c4529d8f73466054f3caa87">LineLineIntersect</a> (float p1[3], float p2[3], float p3[3], float p4[3], float pa[3], float pb[3], double &amp;mua, double &amp;mub)</td></tr>
<tr class="separator:ac5b38de32c4529d8f73466054f3caa87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a472f2149e5e4e469ea283757bf224ed0"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEdbMath.html#a472f2149e5e4e469ea283757bf224ed0">LinFitCOV</a> (int n, float *x, float *y, double *c, float *<a class="el" href="testTT_8C.html#ac483f6ce851c9ecd9fb835ff7551737c">p</a>, float *<a class="el" href="tr__stop_8C.html#a06ff3b9521de2f6a4e82b256e48e902a">d</a>, float *<a class="el" href="testBGReduction__By__ANN_8C.html#a082355e565720d186f24f6cf40baa49f">chi2</a>)</td></tr>
<tr class="separator:a472f2149e5e4e469ea283757bf224ed0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72b2a2be541652c83e191eca81e03d5e"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEdbMath.html#a72b2a2be541652c83e191eca81e03d5e">LinFitDiag</a> (int n, float *x, float *y, float *e, float <a class="el" href="testTT_8C.html#ac483f6ce851c9ecd9fb835ff7551737c">p</a>[2], float <a class="el" href="tr__stop_8C.html#a06ff3b9521de2f6a4e82b256e48e902a">d</a>[2][2], float *<a class="el" href="testBGReduction__By__ANN_8C.html#a082355e565720d186f24f6cf40baa49f">chi2</a>)</td></tr>
<tr class="separator:a72b2a2be541652c83e191eca81e03d5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4576b54adf9a521bed06b3a15aafbf63"><td class="memItemLeft" align="right" valign="top">static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEdbMath.html#a4576b54adf9a521bed06b3a15aafbf63">Magnitude3</a> (float Point1[3], float Point2[3])</td></tr>
<tr class="separator:a4576b54adf9a521bed06b3a15aafbf63"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="aac1d05ff6ea6bea788c91790ae4abc0d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac1d05ff6ea6bea788c91790ae4abc0d">&#9670;&nbsp;</a></span>EdbMath()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">EdbMath::EdbMath </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;{}  </div>
</div><!-- fragment -->
</div>
</div>
<a id="a5fdc34d2f809ad1d30ff0a1d38473b0e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5fdc34d2f809ad1d30ff0a1d38473b0e">&#9670;&nbsp;</a></span>~EdbMath()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual EdbMath::~EdbMath </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;{}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a75a9e60614f2f7f5b74f8b3aa9b8d896"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a75a9e60614f2f7f5b74f8b3aa9b8d896">&#9670;&nbsp;</a></span>Angle3()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double EdbMath::Angle3 </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>tx1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>ty1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>tx2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>ty2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;{</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <span class="comment">// calculate space angle between two vectors defined by the direction tangents</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <span class="keywordtype">double</span> a2 = tx1*tx1+ty1*ty1+1;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="keywordtype">double</span> b2 = tx2*tx2+ty2*ty2+1;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="energy_8C.html#ab733df18de89992ff2876f26188efdc5">c2</a> = tx1*tx2+ty1*ty2+1;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <span class="keywordflow">return</span> ACos( <a class="code" href="energy_8C.html#ab733df18de89992ff2876f26188efdc5">c2</a>/Sqrt(a2*b2) );</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;}</div>
<div class="ttc" id="aenergy_8C_html_ab733df18de89992ff2876f26188efdc5"><div class="ttname"><a href="energy_8C.html#ab733df18de89992ff2876f26188efdc5">c2</a></div><div class="ttdeci">TCanvas * c2</div><div class="ttdef"><b>Definition:</b> energy.C:26</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa5084fc6a6adbb578f88fba629e524ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5084fc6a6adbb578f88fba629e524ad">&#9670;&nbsp;</a></span>ArrStat()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int EdbMath::ArrStat </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>par</em>[4]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;{</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  <span class="comment">// calculate array statistics: </span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  <span class="comment">// output: par (mean, rms, xmin, xmax);</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  </div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  <span class="keywordflow">if</span>(n&lt;1) <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  par[0]=par[2]=par[3]=x[0];</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  <span class="keywordtype">double</span> xs=0;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;n; i++) xs+=x[i];</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  <span class="keywordtype">double</span> x0 = xs/n;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <span class="keywordtype">double</span> dxs=0;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;n; i++) dxs += ((x[i]-x0)*(x[i]-x0));</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <span class="keywordtype">double</span> rms = Sqrt(dxs/n);</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;n; i++) par[2] = par[2]&lt;x[i]?par[2]:x[i];</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;n; i++) par[3] = par[3]&gt;x[i]?par[3]:x[i];</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  par[0]=x0;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  par[1]=rms;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <span class="keywordflow">return</span> n;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab6c275f3d3fa9ee955de93d060fdbb30"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab6c275f3d3fa9ee955de93d060fdbb30">&#9670;&nbsp;</a></span>DistancePointLine3()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double EdbMath::DistancePointLine3 </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>Point</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>LineStart</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>LineEnd</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>inside</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;{</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <span class="comment">// Disclamer: This is a modified code from site of Paul Bourke</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160; </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="keywordtype">double</span> LineMag;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="keywordtype">double</span> U;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="keywordtype">float</span> Intersection[3];</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160; </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    LineMag = <a class="code" href="classEdbMath.html#a4576b54adf9a521bed06b3a15aafbf63">Magnitude3</a>( LineEnd, LineStart );</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    U = ( ( ( Point[0] - LineStart[0] ) * ( LineEnd[0] - LineStart[0] ) ) +</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        ( ( Point[1] - LineStart[1] ) * ( LineEnd[1] - LineStart[1] ) ) +</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        ( ( Point[2] - LineStart[2] ) * ( LineEnd[2] - LineStart[2] ) ) ) /</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        ( LineMag * LineMag );</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="keywordflow">if</span>( U &lt; 0.0f || U &gt; 1.0f )</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;      inside=<span class="keyword">false</span>;   <span class="comment">// closest point does not fall within the line segment</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="keywordflow">else</span> inside=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    Intersection[0] = LineStart[0] + U * ( LineEnd[0] - LineStart[0] );</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    Intersection[1] = LineStart[1] + U * ( LineEnd[1] - LineStart[1] );</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    Intersection[2] = LineStart[2] + U * ( LineEnd[2] - LineStart[2] );</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160; </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classEdbMath.html#a4576b54adf9a521bed06b3a15aafbf63">Magnitude3</a>( Point, Intersection );</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;}</div>
<div class="ttc" id="aclassEdbMath_html_a4576b54adf9a521bed06b3a15aafbf63"><div class="ttname"><a href="classEdbMath.html#a4576b54adf9a521bed06b3a15aafbf63">EdbMath::Magnitude3</a></div><div class="ttdeci">static double Magnitude3(float Point1[3], float Point2[3])</div><div class="ttdef"><b>Definition:</b> EdbMath.cxx:52</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4762a9abac1bbf8e674e0d8a40e5ed0e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4762a9abac1bbf8e674e0d8a40e5ed0e">&#9670;&nbsp;</a></span>LFIT3()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int EdbMath::LFIT3 </td>
          <td>(</td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>Y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>Z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>W</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float &amp;&#160;</td>
          <td class="paramname"><em>X0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float &amp;&#160;</td>
          <td class="paramname"><em>Y0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float &amp;&#160;</td>
          <td class="paramname"><em>Z0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float &amp;&#160;</td>
          <td class="paramname"><em>TX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float &amp;&#160;</td>
          <td class="paramname"><em>TY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float &amp;&#160;</td>
          <td class="paramname"><em>EX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float &amp;&#160;</td>
          <td class="paramname"><em>EY</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;{</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  <span class="comment">// Linar fit in 3-d case (microtrack-like)</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  <span class="comment">// Input: X,Y,Z - coords, W -weight - arrays of the lengh &gt;=L</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <span class="comment">//        Note that X,Y,Z modified by function</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  <span class="comment">// Output: X0,Y0,Z0 - center of gravity of segment</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  <span class="comment">//         TX,TY : tangents in respect to Z axis</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160; </div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  <span class="keywordflow">if</span>(L&lt;2) <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160; </div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  <span class="comment">// first find C.O.G.:</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  <span class="keywordtype">double</span> wx=0, wy=0, wz=0, <a class="code" href="test_8C.html#a0398c1851254d7329d0fc08309c68b6c">w</a>=0;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;L; i++) {</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    wx += <a class="code" href="namespaceHeader_1_1Center.html#a89edd47c72c6d65a49f07a590948166a">X</a>[i]*<a class="code" href="testBGReduction__By__ANN_8C.html#a3eb16b560d3adb6d694d0735cb73b9f6">W</a>[i];</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    wy += <a class="code" href="namespaceHeader_1_1Center.html#ae0431672ca825ee7e225d92187d111f8">Y</a>[i]*<a class="code" href="testBGReduction__By__ANN_8C.html#a3eb16b560d3adb6d694d0735cb73b9f6">W</a>[i];</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    wz += <a class="code" href="emthickness_8cpp.html#a1576eaf58e4371bc3238da5580c6679a">Z</a>[i]*<a class="code" href="testBGReduction__By__ANN_8C.html#a3eb16b560d3adb6d694d0735cb73b9f6">W</a>[i];</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <a class="code" href="test_8C.html#a0398c1851254d7329d0fc08309c68b6c">w</a>  += <a class="code" href="testBGReduction__By__ANN_8C.html#a3eb16b560d3adb6d694d0735cb73b9f6">W</a>[i];</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  }</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  <a class="code" href="emthickness_8cpp.html#a33f147dcd90e03458447d9191f044316">X0</a> = wx/<a class="code" href="test_8C.html#a0398c1851254d7329d0fc08309c68b6c">w</a>;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  <a class="code" href="emthickness_8cpp.html#a548eee315dc4d7f1a3547451d4ef9c69">Y0</a> = wy/<a class="code" href="test_8C.html#a0398c1851254d7329d0fc08309c68b6c">w</a>;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  <a class="code" href="hwinit_8C.html#a96c31e89763ed89de18ee0a2945004ce">Z0</a> = wz/<a class="code" href="test_8C.html#a0398c1851254d7329d0fc08309c68b6c">w</a>;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;L; i++) {</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <a class="code" href="namespaceHeader_1_1Center.html#a89edd47c72c6d65a49f07a590948166a">X</a>[i] -= <a class="code" href="emthickness_8cpp.html#a33f147dcd90e03458447d9191f044316">X0</a>;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <a class="code" href="namespaceHeader_1_1Center.html#ae0431672ca825ee7e225d92187d111f8">Y</a>[i] -= <a class="code" href="emthickness_8cpp.html#a548eee315dc4d7f1a3547451d4ef9c69">Y0</a>;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <a class="code" href="emthickness_8cpp.html#a1576eaf58e4371bc3238da5580c6679a">Z</a>[i] -= <a class="code" href="hwinit_8C.html#a96c31e89763ed89de18ee0a2945004ce">Z0</a>;</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  }</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160; </div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  <span class="keywordflow">if</span>(L==2) {</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <a class="code" href="namespaceHeader_1_1Transform.html#ab0fee3d7a66653a89ef08dfa930974fe">TX</a> = (<a class="code" href="namespaceHeader_1_1Center.html#a89edd47c72c6d65a49f07a590948166a">X</a>[1]-<a class="code" href="namespaceHeader_1_1Center.html#a89edd47c72c6d65a49f07a590948166a">X</a>[0])/(<a class="code" href="emthickness_8cpp.html#a1576eaf58e4371bc3238da5580c6679a">Z</a>[1]-<a class="code" href="emthickness_8cpp.html#a1576eaf58e4371bc3238da5580c6679a">Z</a>[0]);</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <a class="code" href="namespaceHeader_1_1Transform.html#a77cc5bed5e066bdb8211aaac443ec107">TY</a> = (<a class="code" href="namespaceHeader_1_1Center.html#ae0431672ca825ee7e225d92187d111f8">Y</a>[1]-<a class="code" href="namespaceHeader_1_1Center.html#ae0431672ca825ee7e225d92187d111f8">Y</a>[0])/(<a class="code" href="emthickness_8cpp.html#a1576eaf58e4371bc3238da5580c6679a">Z</a>[1]-<a class="code" href="emthickness_8cpp.html#a1576eaf58e4371bc3238da5580c6679a">Z</a>[0]);</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    EX=EY=0;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="keywordflow">return</span> L;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  }</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160; </div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;  <span class="keywordtype">float</span> x0=0,y0=0;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  <a class="code" href="classEdbMath.html#a621ec2567e15829a0365cff42987bfe9">EdbMath::LFITW</a>( <a class="code" href="emthickness_8cpp.html#a1576eaf58e4371bc3238da5580c6679a">Z</a>,<a class="code" href="namespaceHeader_1_1Center.html#a89edd47c72c6d65a49f07a590948166a">X</a>,<a class="code" href="testBGReduction__By__ANN_8C.html#a3eb16b560d3adb6d694d0735cb73b9f6">W</a>, L, 1, <a class="code" href="namespaceHeader_1_1Transform.html#ab0fee3d7a66653a89ef08dfa930974fe">TX</a>,x0,EX );</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  <a class="code" href="classEdbMath.html#a621ec2567e15829a0365cff42987bfe9">EdbMath::LFITW</a>( <a class="code" href="emthickness_8cpp.html#a1576eaf58e4371bc3238da5580c6679a">Z</a>,<a class="code" href="namespaceHeader_1_1Center.html#ae0431672ca825ee7e225d92187d111f8">Y</a>,<a class="code" href="testBGReduction__By__ANN_8C.html#a3eb16b560d3adb6d694d0735cb73b9f6">W</a>, L, 1, <a class="code" href="namespaceHeader_1_1Transform.html#a77cc5bed5e066bdb8211aaac443ec107">TY</a>,y0,EY );</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160; </div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  <a class="code" href="emthickness_8cpp.html#a33f147dcd90e03458447d9191f044316">X0</a> += x0;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  <a class="code" href="emthickness_8cpp.html#a548eee315dc4d7f1a3547451d4ef9c69">Y0</a> += y0;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  </div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  <span class="keywordflow">return</span> L;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;}</div>
<div class="ttc" id="aclassEdbMath_html_a621ec2567e15829a0365cff42987bfe9"><div class="ttname"><a href="classEdbMath.html#a621ec2567e15829a0365cff42987bfe9">EdbMath::LFITW</a></div><div class="ttdeci">static void LFITW(float *X, float *Y, float *W, int L, int KEY, float &amp;A, float &amp;B, float &amp;E)</div><div class="ttdef"><b>Definition:</b> EdbMath.cxx:262</div></div>
<div class="ttc" id="aemthickness_8cpp_html_a1576eaf58e4371bc3238da5580c6679a"><div class="ttname"><a href="emthickness_8cpp.html#a1576eaf58e4371bc3238da5580c6679a">Z</a></div><div class="ttdeci">struct @8 Z</div></div>
<div class="ttc" id="aemthickness_8cpp_html_a33f147dcd90e03458447d9191f044316"><div class="ttname"><a href="emthickness_8cpp.html#a33f147dcd90e03458447d9191f044316">X0</a></div><div class="ttdeci">float X0</div><div class="ttdef"><b>Definition:</b> emthickness.cpp:69</div></div>
<div class="ttc" id="aemthickness_8cpp_html_a548eee315dc4d7f1a3547451d4ef9c69"><div class="ttname"><a href="emthickness_8cpp.html#a548eee315dc4d7f1a3547451d4ef9c69">Y0</a></div><div class="ttdeci">float Y0</div><div class="ttdef"><b>Definition:</b> emthickness.cpp:70</div></div>
<div class="ttc" id="ahwinit_8C_html_a96c31e89763ed89de18ee0a2945004ce"><div class="ttname"><a href="hwinit_8C.html#a96c31e89763ed89de18ee0a2945004ce">Z0</a></div><div class="ttdeci">float Z0</div><div class="ttdef"><b>Definition:</b> hwinit.C:67</div></div>
<div class="ttc" id="anamespaceHeader_1_1Center_html_a89edd47c72c6d65a49f07a590948166a"><div class="ttname"><a href="namespaceHeader_1_1Center.html#a89edd47c72c6d65a49f07a590948166a">Header::Center::X</a></div><div class="ttdeci">Double_t X</div><div class="ttdef"><b>Definition:</b> tlg2pattern.C:77</div></div>
<div class="ttc" id="anamespaceHeader_1_1Center_html_ae0431672ca825ee7e225d92187d111f8"><div class="ttname"><a href="namespaceHeader_1_1Center.html#ae0431672ca825ee7e225d92187d111f8">Header::Center::Y</a></div><div class="ttdeci">Double_t Y</div><div class="ttdef"><b>Definition:</b> tlg2pattern.C:77</div></div>
<div class="ttc" id="anamespaceHeader_1_1Transform_html_a77cc5bed5e066bdb8211aaac443ec107"><div class="ttname"><a href="namespaceHeader_1_1Transform.html#a77cc5bed5e066bdb8211aaac443ec107">Header::Transform::TY</a></div><div class="ttdeci">Double_t TY</div><div class="ttdef"><b>Definition:</b> tlg2pattern.C:79</div></div>
<div class="ttc" id="anamespaceHeader_1_1Transform_html_ab0fee3d7a66653a89ef08dfa930974fe"><div class="ttname"><a href="namespaceHeader_1_1Transform.html#ab0fee3d7a66653a89ef08dfa930974fe">Header::Transform::TX</a></div><div class="ttdeci">Double_t TX</div><div class="ttdef"><b>Definition:</b> tlg2pattern.C:79</div></div>
<div class="ttc" id="atestBGReduction__By__ANN_8C_html_a3eb16b560d3adb6d694d0735cb73b9f6"><div class="ttname"><a href="testBGReduction__By__ANN_8C.html#a3eb16b560d3adb6d694d0735cb73b9f6">W</a></div><div class="ttdeci">Int_t W</div><div class="ttdef"><b>Definition:</b> testBGReduction_By_ANN.C:15</div></div>
<div class="ttc" id="atest_8C_html_a0398c1851254d7329d0fc08309c68b6c"><div class="ttname"><a href="test_8C.html#a0398c1851254d7329d0fc08309c68b6c">w</a></div><div class="ttdeci">void w(int rid=2, int nviews=2)</div><div class="ttdef"><b>Definition:</b> test.C:27</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a621ec2567e15829a0365cff42987bfe9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a621ec2567e15829a0365cff42987bfe9">&#9670;&nbsp;</a></span>LFITW()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="Milproto_8h.html#ad25c00c18486b3c83c838f69f1af4204">void</a> EdbMath::LFITW </td>
          <td>(</td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>Y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>W</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>KEY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float &amp;&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float &amp;&#160;</td>
          <td class="paramname"><em>B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float &amp;&#160;</td>
          <td class="paramname"><em>E</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;{</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  <span class="comment">// E250:</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  <span class="comment">//     TO PERFORM A WEIGHTED STRAIGHT LINE FIT</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  <span class="comment">//     FOR FORMULAE USED SEE MENZEL, FORMULAS OF PHYSICS P.116</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  <span class="comment">//     FIT IS OF Y=AX+B , WITH S**2 ESTIMATOR E. WEIGHTS ARE IN W.</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  <span class="comment">//     IF KEY=0, POINTS WITH Y=0 ARE IGNORED</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  <span class="comment">//     L IS NO. OF POINTS</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160; </div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  A=0; <a class="code" href="emthickness_8cpp.html#a35d5b4c2bfa16a3c612587f58411a75f">B</a>=0; E=0;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160; </div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  <span class="comment">//     CALCULTE SUMS</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  <span class="keywordflow">if</span>(L&lt;2)  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160; </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  <span class="keywordtype">double</span> WW=0.;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  <span class="keywordtype">double</span> WWF=0.;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  <span class="keywordtype">double</span> WWFI=0.;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  <span class="keywordtype">double</span> W2=0.;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  <span class="keywordtype">double</span> W2X=0.;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  <span class="keywordtype">double</span> W2Y=0.;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  <span class="keywordtype">double</span> W2XY=0.;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  <span class="keywordtype">double</span> W2X2=0.;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  <span class="keywordtype">double</span> W2Y2=0.;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  <span class="keywordtype">int</span>    ICNT=0;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160; </div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  <span class="keywordflow">for</span>( <span class="keywordtype">int</span> j=0; j&lt;L; j++ ){</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="namespaceHeader_1_1Center.html#ae0431672ca825ee7e225d92187d111f8">Y</a>[j]==0. &amp;&amp; KEY==0 )  <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    WW=<a class="code" href="testBGReduction__By__ANN_8C.html#a3eb16b560d3adb6d694d0735cb73b9f6">W</a>[j]*<a class="code" href="testBGReduction__By__ANN_8C.html#a3eb16b560d3adb6d694d0735cb73b9f6">W</a>[j];</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    W2=WW+W2;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    WWF=WW*<a class="code" href="namespaceHeader_1_1Center.html#a89edd47c72c6d65a49f07a590948166a">X</a>[j];</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    W2X=WWF+W2X;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    W2X2=WWF*<a class="code" href="namespaceHeader_1_1Center.html#a89edd47c72c6d65a49f07a590948166a">X</a>[j]+W2X2;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    W2XY=WWF*<a class="code" href="namespaceHeader_1_1Center.html#ae0431672ca825ee7e225d92187d111f8">Y</a>[j]+W2XY;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    WWFI=WW*<a class="code" href="namespaceHeader_1_1Center.html#ae0431672ca825ee7e225d92187d111f8">Y</a>[j];</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    W2Y=WWFI+W2Y;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    W2Y2=WWFI*<a class="code" href="namespaceHeader_1_1Center.html#ae0431672ca825ee7e225d92187d111f8">Y</a>[j]+W2Y2;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    ICNT++;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  }</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160; </div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  <span class="comment">//     FIT PARAMETERS</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  A=(W2XY-W2X*W2Y/W2)/(W2X2-W2X*W2X/W2);</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  <a class="code" href="emthickness_8cpp.html#a35d5b4c2bfa16a3c612587f58411a75f">B</a>=(W2Y-A*W2X)/W2;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  <span class="keywordflow">if</span>(ICNT&lt;3)     <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  E = (W2Y2-W2Y*W2Y/W2 -</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;       (W2XY-W2X*W2Y/W2)*(W2XY-W2X*W2Y/W2)/(W2X2-W2X*W2X/W2))/(ICNT-2);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;}</div>
<div class="ttc" id="aemthickness_8cpp_html_a35d5b4c2bfa16a3c612587f58411a75f"><div class="ttname"><a href="emthickness_8cpp.html#a35d5b4c2bfa16a3c612587f58411a75f">B</a></div><div class="ttdeci">struct @6 B</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac5b38de32c4529d8f73466054f3caa87"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac5b38de32c4529d8f73466054f3caa87">&#9670;&nbsp;</a></span>LineLineIntersect()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool EdbMath::LineLineIntersect </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>p1</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>p2</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>p3</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>p4</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>pa</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>pb</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>mua</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>mub</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;{</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">// Disclamer: This is a modified code from site of Paul Bourke</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">//     Calculate the line segment PaPb that is the shortest route between</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">//     two lines P1P2 and P3P4. Calculate also the values of mua and mub where</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">//        Pa = P1 + mua (P2 - P1)</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">//        Pb = P3 + mub (P4 - P3)</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">//     Return FALSE if no solution exists (the lines are parallel)</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160; </div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;   <span class="keywordtype">float</span> p13[3],p43[3],p21[3];</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;   <span class="keywordtype">double</span> d1343,d4321,d1321,d4343,d2121;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;   <span class="keywordtype">double</span> numer,denom;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">float</span> EPS=1.E-6;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160; </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;   p13[0] = p1[0] - p3[0];</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;   p13[1] = p1[1] - p3[1];</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;   p13[2] = p1[2] - p3[2];</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;   p43[0] = p4[0] - p3[0];</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;   p43[1] = p4[1] - p3[1];</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;   p43[2] = p4[2] - p3[2];</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;   <span class="keywordflow">if</span> (TMath::Abs(p43[0])  &lt; EPS &amp;&amp; </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;       TMath::Abs(p43[1])  &lt; EPS &amp;&amp; </div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;       TMath::Abs(p43[2])  &lt; EPS)      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;   p21[0] = p2[0] - p1[0];</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;   p21[1] = p2[1] - p1[1];</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;   p21[2] = p2[2] - p1[2];</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;   <span class="keywordflow">if</span> (TMath::Abs(p21[0])  &lt; EPS &amp;&amp; </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;       TMath::Abs(p21[1])  &lt; EPS &amp;&amp; </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;       TMath::Abs(p21[2])  &lt; EPS)      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160; </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;   d1343 = p13[0] * p43[0] + p13[1] * p43[1] + p13[2] * p43[2];<span class="comment">//  e</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;   d4321 = p43[0] * p21[0] + p43[1] * p21[1] + p43[2] * p21[2];<span class="comment">//  b</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;   d1321 = p13[0] * p21[0] + p13[1] * p21[1] + p13[2] * p21[2];<span class="comment">//  d</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;   d4343 = p43[0] * p43[0] + p43[1] * p43[1] + p43[2] * p43[2];<span class="comment">//  c</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;   d2121 = p21[0] * p21[0] + p21[1] * p21[1] + p21[2] * p21[2];<span class="comment">//  a</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160; </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;   <span class="comment">//        a      c       b       b</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;   denom = d2121 * d4343 - d4321 * d4321;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;   <span class="keywordflow">if</span> (TMath::Abs(denom) &lt; EPS) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160; </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;   numer = d1343 * d4321 - d1321 * d4343;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;   mua = numer / denom;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;   mub = (d1343 + d4321 * (mua)) / d4343;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160; </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;   pa[0] = p1[0] + mua * p21[0];</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;   pa[1] = p1[1] + mua * p21[1];</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;   pa[2] = p1[2] + mua * p21[2];</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;   pb[0] = p3[0] + mub * p43[0];</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;   pb[1] = p3[1] + mub * p43[1];</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;   pb[2] = p3[2] + mub * p43[2];</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160; </div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;   <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a472f2149e5e4e469ea283757bf224ed0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a472f2149e5e4e469ea283757bf224ed0">&#9670;&nbsp;</a></span>LinFitCOV()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool EdbMath::LinFitCOV </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>chi2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;{</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  <span class="comment">// linear fit by YP with using full covariance matrix of measurements :  </span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  <span class="comment">//                  y = p[0] + p[1]*x , d[2][2] is error matrix for p[2]</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  <span class="comment">// Input : n     - number of points</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <span class="comment">//         x,y - data arrays of the length n</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  <span class="comment">//         c   - full covariance matrix c[n][n]</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="keywordflow">if</span> (n &lt; 2) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="keywordtype">int</span> i = 0, j = 0;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="keywordtype">double</span> dy = 0;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160; </div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    TMatrixD D(n,n);   <span class="comment">// error matrix of measurements</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    TMatrixD A(n,2);   <span class="comment">// construction matrix</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    TMatrixD AT(2,n);  <span class="comment">// A transposed</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    TVectorD <a class="code" href="namespaceHeader_1_1Center.html#ae0431672ca825ee7e225d92187d111f8">Y</a>(n);     <span class="comment">// measurements vector</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    TVectorD Y1(n);    <span class="comment">// temporary vector</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    TVectorD DY(n);    <span class="comment">// residuals</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    TMatrixD DI(n,n);  <span class="comment">// Inverse of D-matrix</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    TMatrixD DP(2,2);  <span class="comment">// error matrix of parameters</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    TMatrixD <a class="code" href="emthickness_8cpp.html#a35d5b4c2bfa16a3c612587f58411a75f">B</a>(2,2);   <span class="comment">// inverse error matrix of parameters</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    TVectorD <a class="code" href="emthickness_8cpp.html#a01978a323d209ecbab880e5d1c258cbd">P</a>(2);     <span class="comment">// parameters vector</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160; </div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="keywordflow">for</span> (i=0; i&lt;n; i++)</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    {</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    A(i,0) = (double)1.;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    A(i,1) = (double)x[i];</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    AT(0,i) = A(i,0);</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    AT(1,i) = A(i,1);</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <a class="code" href="namespaceHeader_1_1Center.html#ae0431672ca825ee7e225d92187d111f8">Y</a>(i) = (double)y[i];</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="keywordflow">for</span> (j=0; j&lt;n; j++)</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    {</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        D(i,j) = (double)(*(c+i*n+j));</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    }   </div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    }</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160; </div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    Y1 = <a class="code" href="namespaceHeader_1_1Center.html#ae0431672ca825ee7e225d92187d111f8">Y</a>;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    DI = D.Invert();</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <a class="code" href="emthickness_8cpp.html#a35d5b4c2bfa16a3c612587f58411a75f">B</a>  = AT*(DI*A);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    DP = <a class="code" href="emthickness_8cpp.html#a35d5b4c2bfa16a3c612587f58411a75f">B</a>.Invert();</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    Y1 *= DI;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    AT.ResizeTo(n,n);</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    Y1 *= AT; </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    Y1.ResizeTo(2);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <a class="code" href="emthickness_8cpp.html#a01978a323d209ecbab880e5d1c258cbd">P</a>  = Y1;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <a class="code" href="emthickness_8cpp.html#a01978a323d209ecbab880e5d1c258cbd">P</a>  *= DP;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    </div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="keywordflow">for</span> (i=0; i&lt;2; i++)</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    {</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    *(<a class="code" href="testBGReduction__AllMethods_8C.html#ac483f6ce851c9ecd9fb835ff7551737c">p</a>+i) = (<span class="keywordtype">float</span>)<a class="code" href="emthickness_8cpp.html#a01978a323d209ecbab880e5d1c258cbd">P</a>(i);</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="keywordflow">for</span> (j=0; j&lt;2; j++)</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    {</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        *(<a class="code" href="RecDispEX_8C.html#a06ff3b9521de2f6a4e82b256e48e902a">d</a>+i*2+j) = (<span class="keywordtype">float</span>)DP(i,j);</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    }</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    }</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    </div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="keywordflow">for</span> (i=0; i&lt;n; i++)</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    {</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    dy = (double)(y[i] - *<a class="code" href="testBGReduction__AllMethods_8C.html#ac483f6ce851c9ecd9fb835ff7551737c">p</a> - (*(<a class="code" href="testBGReduction__AllMethods_8C.html#ac483f6ce851c9ecd9fb835ff7551737c">p</a>+1))*x[i]);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    DY(i) = dy;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    }</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    TVectorD DY1 = DY;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    DY *= DI;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    *<a class="code" href="testBGReduction__By__ANN_8C.html#a082355e565720d186f24f6cf40baa49f">chi2</a> = (float)(DY1*DY);</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160; </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;}</div>
<div class="ttc" id="aRecDispEX_8C_html_a06ff3b9521de2f6a4e82b256e48e902a"><div class="ttname"><a href="RecDispEX_8C.html#a06ff3b9521de2f6a4e82b256e48e902a">d</a></div><div class="ttdeci">void d()</div><div class="ttdef"><b>Definition:</b> RecDispEX.C:381</div></div>
<div class="ttc" id="aemthickness_8cpp_html_a01978a323d209ecbab880e5d1c258cbd"><div class="ttname"><a href="emthickness_8cpp.html#a01978a323d209ecbab880e5d1c258cbd">P</a></div><div class="ttdeci">struct @7 P</div></div>
<div class="ttc" id="atestBGReduction__AllMethods_8C_html_ac483f6ce851c9ecd9fb835ff7551737c"><div class="ttname"><a href="testBGReduction__AllMethods_8C.html#ac483f6ce851c9ecd9fb835ff7551737c">p</a></div><div class="ttdeci">p</div><div class="ttdef"><b>Definition:</b> testBGReduction_AllMethods.C:8</div></div>
<div class="ttc" id="atestBGReduction__By__ANN_8C_html_a082355e565720d186f24f6cf40baa49f"><div class="ttname"><a href="testBGReduction__By__ANN_8C.html#a082355e565720d186f24f6cf40baa49f">chi2</a></div><div class="ttdeci">Float_t chi2</div><div class="ttdef"><b>Definition:</b> testBGReduction_By_ANN.C:14</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a72b2a2be541652c83e191eca81e03d5e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a72b2a2be541652c83e191eca81e03d5e">&#9670;&nbsp;</a></span>LinFitDiag()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool EdbMath::LinFitDiag </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>e</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>p</em>[2], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>d</em>[2][2], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>chi2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;{</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  <span class="comment">// linear fit by YP:  y = p[0] + p[1]*x , d[2][2] is error matrix for p[2]</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  <span class="comment">// Input : n     - number of points</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <span class="comment">//         x,y,e - data arrays of the length n</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="keywordflow">if</span> (n &lt; 2) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keywordtype">int</span> i = 0;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="test_8C.html#a0398c1851254d7329d0fc08309c68b6c">w</a> = 0., ed = 0.;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="keywordtype">double</span> sw = 0., swx = 0., swx2 = 0., swy = 0., swxy = 0.;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="keywordtype">float</span> dy = 0.;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160; </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="keywordflow">for</span> (i=0; i&lt;n; i++)</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    {</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    ed = (double)e[i];</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="keywordflow">if</span> (ed &gt; 0.)</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    {</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        <a class="code" href="test_8C.html#a0398c1851254d7329d0fc08309c68b6c">w</a> = 1./(ed*ed);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        sw   += <a class="code" href="test_8C.html#a0398c1851254d7329d0fc08309c68b6c">w</a>;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        swx  += <a class="code" href="test_8C.html#a0398c1851254d7329d0fc08309c68b6c">w</a>*x[i];</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        swx2 += <a class="code" href="test_8C.html#a0398c1851254d7329d0fc08309c68b6c">w</a>*x[i]*x[i];</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        swy  += <a class="code" href="test_8C.html#a0398c1851254d7329d0fc08309c68b6c">w</a>*y[i];</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        swxy += <a class="code" href="test_8C.html#a0398c1851254d7329d0fc08309c68b6c">w</a>*x[i]*y[i];</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    }</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    }</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="keywordtype">double</span> det = sw*swx2 - swx*swx;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="keywordflow">if</span> (det == 0.) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <a class="code" href="RecDispEX_8C.html#a06ff3b9521de2f6a4e82b256e48e902a">d</a>[0][0] = (float)( swx2/det);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <a class="code" href="RecDispEX_8C.html#a06ff3b9521de2f6a4e82b256e48e902a">d</a>[0][1] = (float)(-swx/det);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <a class="code" href="RecDispEX_8C.html#a06ff3b9521de2f6a4e82b256e48e902a">d</a>[1][0] = <a class="code" href="RecDispEX_8C.html#a06ff3b9521de2f6a4e82b256e48e902a">d</a>[0][1];</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <a class="code" href="RecDispEX_8C.html#a06ff3b9521de2f6a4e82b256e48e902a">d</a>[1][1] = (float)(sw/det);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <a class="code" href="testBGReduction__AllMethods_8C.html#ac483f6ce851c9ecd9fb835ff7551737c">p</a>[0] = (float)((swy*swx2 - swxy*swx)/det);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <a class="code" href="testBGReduction__AllMethods_8C.html#ac483f6ce851c9ecd9fb835ff7551737c">p</a>[1] = (float)((swxy*sw  - swy*swx)/det);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    *<a class="code" href="testBGReduction__By__ANN_8C.html#a082355e565720d186f24f6cf40baa49f">chi2</a> = 0.;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="keywordflow">for</span> (i=0; i&lt;n; i++)</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    {</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="keywordflow">if</span> ( e[i] &gt; 0.)</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    {</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        dy = y[i] - <a class="code" href="testBGReduction__AllMethods_8C.html#ac483f6ce851c9ecd9fb835ff7551737c">p</a>[0] - <a class="code" href="testBGReduction__AllMethods_8C.html#ac483f6ce851c9ecd9fb835ff7551737c">p</a>[1]*x[i];</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        *<a class="code" href="testBGReduction__By__ANN_8C.html#a082355e565720d186f24f6cf40baa49f">chi2</a> += dy*dy/(e[i]*e[i]);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    }</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    }</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a4576b54adf9a521bed06b3a15aafbf63"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4576b54adf9a521bed06b3a15aafbf63">&#9670;&nbsp;</a></span>Magnitude3()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double EdbMath::Magnitude3 </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>Point1</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>Point2</em>[3]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;{</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="keywordtype">double</span> dx = Point2[0] - Point1[0];</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="keywordtype">double</span> dy = Point2[1] - Point1[1];</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="RecDispMC_8C.html#a0f18a47f79c00d5338b61e60e7227a6e">dz</a> = Point2[2] - Point1[2];</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="keywordflow">return</span> TMath::Sqrt( dx*dx+dy*dy+<a class="code" href="RecDispMC_8C.html#a0f18a47f79c00d5338b61e60e7227a6e">dz</a>*<a class="code" href="RecDispMC_8C.html#a0f18a47f79c00d5338b61e60e7227a6e">dz</a> );</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;}</div>
<div class="ttc" id="aRecDispMC_8C_html_a0f18a47f79c00d5338b61e60e7227a6e"><div class="ttname"><a href="RecDispMC_8C.html#a0f18a47f79c00d5338b61e60e7227a6e">dz</a></div><div class="ttdeci">brick dz</div><div class="ttdef"><b>Definition:</b> RecDispMC.C:107</div></div>
</div><!-- fragment -->
</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>src/libEmath/<a class="el" href="EdbMath_8h_source.html">EdbMath.h</a></li>
<li>src/libEmath/<a class="el" href="EdbMath_8cxx.html">EdbMath.cxx</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="classEdbMath.html">EdbMath</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
